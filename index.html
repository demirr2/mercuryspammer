<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mercury Spammer — Token Loader (Local)</title>
<style>
  :root{ --bg:#050008; --neon1:#9b5cff; --neon2:#ff66cc; }
  body{ margin:0; min-height:100vh; background:var(--bg); color:#fff; font-family:Inter, "Poppins", system-ui, sans-serif;
         display:flex; align-items:center; justify-content:center; padding:32px; }
  .panel{
    width:980px; max-width:calc(100% - 48px); display:flex; gap:28px; border-radius:14px; padding:20px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.08));
    box-shadow:0 20px 60px rgba(0,0,0,0.6);
  }
  /* left: saturn */
  .left { width:340px; display:flex; flex-direction:column; align-items:center; gap:16px; position:relative; }
  .avatar{ width:220px;height:220px; display:flex;align-items:center;justify-content:center; position:relative; }
  .saturn{ width:180px;height:180px;border-radius:50%;
    background: radial-gradient(circle at 30% 30%, #ff9bff, #5e00a8 70%);
    box-shadow: 0 0 40px #a94eff, 0 0 80px rgba(200,0,255,0.4); animation:spin 10s linear infinite; z-index:2; }
  .ring{ position:absolute; width:260px;height:70px;border-radius:50%;
    background: linear-gradient(90deg,#d37cff,#9b5cff,#ff66cc,#d37cff);
    transform: translateY(-10px) rotateX(70deg); filter:blur(0.6px); animation:ringRotate 6s linear infinite; z-index:1; }
  .saturn-glow{ position:absolute; width:220px;height:220px;border-radius:50%;
    box-shadow:0 0 120px 40px rgba(180,0,255,0.25); animation:pulse 2.5s ease-in-out infinite alternate; z-index:0; }
  @keyframes spin{ from{transform:rotate(0deg)} to{transform:rotate(360deg)} }
  @keyframes ringRotate{ from{transform: translateY(-10px) rotateX(70deg) rotateZ(0deg)} to{transform: translateY(-10px) rotateX(70deg) rotateZ(360deg)} }
  @keyframes pulse{ from{opacity:.7; transform:scale(.95)} to{opacity:1; transform:scale(1.05)} }

  /* right: form & token yönetimi */
  .right{ flex:1; display:flex; flex-direction:column; gap:12px; }
  .header{ display:flex;align-items:center;justify-content:space-between;gap:12px; }
  .title{ font-size:20px;font-weight:800; letter-spacing:0.4px; }
  .form-card{
    padding:14px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);
    display:flex;flex-direction:column;gap:10px;
  }
  label{ font-size:13px;color:rgba(255,255,255,0.85); font-weight:700; }
  input[type="text"], textarea {
    width:100%; padding:10px 12px; border-radius:8px;border:1px solid rgba(255,255,255,0.06);
    background:rgba(255,255,255,0.02); color:#eaf6ff; font-family:monospace;
  }
  .controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .btn {
    padding:10px 14px; border-radius:10px; font-weight:800; cursor:pointer; border:none;
    background:linear-gradient(90deg,var(--neon1),var(--neon2)); color:#041017;
    box-shadow:0 6px 20px rgba(155,92,255,0.12);
  }
  .btn.secondary{ background:transparent;color:#fff;border:1px solid rgba(255,255,255,0.06); box-shadow:none }
  .status { font-size:13px;color:rgba(255,255,255,0.8); margin-left:6px; }

  .tokens {
    margin-top:6px; background:rgba(0,0,0,0.12); padding:12px;border-radius:8px; max-height:210px; overflow:auto;
    border:1px solid rgba(255,255,255,0.02);
  }
  .token-row{ display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:6px; margin-bottom:6px;
    background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005)); font-family:monospace; font-size:13px;
  }
  .token-row .leftcol{ display:flex;gap:10px;align-items:center; }
  .token-row button{ padding:6px 8px; font-size:12px; border-radius:8px; border:none; cursor:pointer; background:rgba(255,255,255,0.04); color:#fff; }

  .muted{ color:rgba(255,255,255,0.5); font-size:13px; }
  .small { font-size:12px;color:rgba(255,255,255,0.6); }

  @media (max-width:920px){ .panel{ flex-direction:column; align-items:center; } .left{ order:2 } }
</style>
</head>
<body>

  <div class="panel" role="application" aria-label="Mercury Spammer Panel - local token loader">
    <div class="left" aria-hidden="false">
      <div class="avatar" aria-hidden="true">
        <div class="ring"></div>
        <div class="saturn"></div>
        <div class="saturn-glow"></div>
      </div>
      <div style="text-align:center">
        <div style="font-size:18px;font-weight:900">KANKA RIG</div>
        <div class="muted">Mor Satürn Modu — Local token loader</div>
      </div>
    </div>

    <div class="right">
      <div class="header">
        <div class="title">Mercury Spammer</div>
        <div class="small muted">Dosyadan token yükleme (sadece local)</div>
      </div>

      <div class="form-card" role="form" aria-label="Mercury form">
        <div>
          <label for="channelId">Channel ID (Discord kanal ID'si)</label>
          <input id="channelId" type="text" placeholder="Örn: 123456789012345678" />
        </div>

        <div>
          <label for="message">Message (gönderilecek mesaj)</label>
          <textarea id="message" rows="4" placeholder="Gönderilecek mesaj..."></textarea>
        </div>

        <div class="controls">
          <!-- gizli file input -->
          <input id="fileInput" type="file" accept=".txt,text/plain" style="display:none" />

          <button id="addTokenBtn" class="btn" title="Satır satır token içeren .txt dosyası seç">Add Token (Dosya)</button>

          <div class="status" id="status">Yüklenen: <strong id="count">0</strong> token</div>
        </div>

        <div style="display:flex;gap:8px;align-items:center;margin-top:6px">
          <button id="exportBtn" class="btn secondary">Export (.txt)</button>
          <button id="clearBtn" class="btn secondary">Clear All</button>
          <div class="small muted">Preview (ilk 20 maskelenmiş)</div>
        </div>

        <div class="tokens" id="tokensBox" aria-live="polite">
          <div class="small muted">Henüz token yok.</div>
        </div>
      </div>
    </div>
  </div>

<script>
/*
  Davranış:
  - Tokenler localStorage'da tutulur (STORAGE_KEY)
  - Kullanıcı sayfayı gizlediğinde veya unload olduğunda EXPIRY_KEY'e Date.now()+5*60*1000 yazılır.
  - Kullanıcı geri dönerse (visibilitychange visible) EXPIRY_KEY temizlenir.
  - Periyodik kontrol expiry geçtiyse tokenler silinir.
  - Manual Add tamamen kaldırıldı.
*/

const STORAGE_KEY = 'mercury_tokens';
const EXPIRY_KEY = 'mercury_tokens_expiry';
const fileInput = document.getElementById('fileInput');
const addTokenBtn = document.getElementById('addTokenBtn');
const tokensBox = document.getElementById('tokensBox');
const countEl = document.getElementById('count');
const exportBtn = document.getElementById('exportBtn');
const clearBtn = document.getElementById('clearBtn');

function loadTokens(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    return raw ? JSON.parse(raw) : [];
  }catch(e){ return []; }
}
function saveTokens(arr){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
  // aktif kullanıcı olduğu için expiry'yi iptal et
  localStorage.removeItem(EXPIRY_KEY);
  renderTokens();
}
function clearTokens(){
  localStorage.removeItem(STORAGE_KEY);
  localStorage.removeItem(EXPIRY_KEY);
  renderTokens();
}

// mask preview
function maskToken(t){
  return t;
}

// simple base64-like validator removed per isteğin; accept any non-empty line
function isTokenLike(s){
  return typeof s === 'string' && s.trim().length > 0;
}

function renderTokens(){
  const tokens = loadTokens();
  countEl.textContent = tokens.length;
  tokensBox.innerHTML = '';
  if(tokens.length === 0){
    tokensBox.innerHTML = '<div class="small muted">Henüz token yok.</div>';
    return;
  }
  const list = document.createElement('div');
  const limit = Math.min(20, tokens.length);
  for(let i=0;i<limit;i++){
    const t = tokens[i];
    const row = document.createElement('div');
    row.className = 'token-row';

    const leftcol = document.createElement('div');
    leftcol.className = 'leftcol';

    const idx = document.createElement('div');
    idx.textContent = (i+1)+'.';
    idx.className = 'small muted';

    const tokenText = document.createElement('div');
    tokenText.textContent = maskToken(t);
    tokenText.title = 'Token preview (maskelenmiş)';

    leftcol.appendChild(idx);
    leftcol.appendChild(tokenText);

    const removeBtn = document.createElement('button');
    removeBtn.textContent = 'Sil';
    removeBtn.title = 'Bu tokeni sil';
    removeBtn.addEventListener('click',()=>{
      const arr = loadTokens();
      arr.splice(i,1);
      saveTokens(arr);
    });

    row.appendChild(leftcol);
    row.appendChild(removeBtn);
    list.appendChild(row);
  }

  if(tokens.length > limit){
    const more = document.createElement('div');
    more.className = 'small muted';
    more.style.marginTop='8px';
    more.textContent = `... ve ${tokens.length - limit} tane daha.`;
    tokensBox.appendChild(list);
    tokensBox.appendChild(more);
  } else {
    tokensBox.appendChild(list);
  }
}

// file loading
addTokenBtn.addEventListener('click', ()=> fileInput.click());
fileInput.addEventListener('change', (ev)=>{
  const f = ev.target.files[0];
  if(!f){ return; }
  if(!f.name.toLowerCase().endsWith('.txt')){
    alert('Lütfen .txt uzantılı dosya seç. Her satır bir token olmalı.');
    fileInput.value='';
    return;
  }
  const reader = new FileReader();
  reader.onload = function(e){
    const text = e.target.result;
    const lines = text.split(/\r?\n/).map(s=>s.trim()).filter(s=>s.length>0);
    if(lines.length === 0){
      alert('Dosyada okunacak satır yok.');
      fileInput.value='';
      return;
    }
    // accept any non-empty lines
    const good = lines.filter(isTokenLike);
    const existing = loadTokens();
    const merged = existing.concat(good.filter(x=>!existing.includes(x)));
    saveTokens(merged);
    fileInput.value='';
    alert(`${good.length} satır eklendi.`);
  };
  reader.onerror = function(){
    alert('Dosya okunamadı.');
    fileInput.value='';
  };
  reader.readAsText(f);
});

// export
exportBtn.addEventListener('click', ()=>{
  const tokens = loadTokens();
  if(tokens.length===0){ alert('Kaydedilmiş token yok.'); return; }
  const blob = new Blob([tokens.join('\n')], {type:'text/plain;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'mercury_tokens.txt';
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
});

// clear
clearBtn.addEventListener('click', ()=>{
  if(!confirm('Tüm tokenleri temizlemek istediğine emin misin?')) return;
  clearTokens();
});

// EXPIRY handling:
// call when page hidden/unload -> set expiry to now + 5min
function setExpiryInFiveMinutes(){
  const expiry = Date.now() + 5 * 60 * 1000; // 5 dakika
  localStorage.setItem(EXPIRY_KEY, String(expiry));
}
// cancel expiry when user returns
function clearExpiry(){
  localStorage.removeItem(EXPIRY_KEY);
}

// on visibility change
document.addEventListener('visibilitychange', ()=>{
  if(document.hidden){
    // user left the page (tab switched or minimized)
    setExpiryInFiveMinutes();
  } else {
    // user returned
    clearExpiry();
  }
});

// on unload (user closes or navigates away) set expiry as well
window.addEventListener('beforeunload', ()=>{
  // we can't do async work here; just set expiry
  setExpiryInFiveMinutes();
});

// periodic check: if expiry passed -> clear tokens
function checkExpiry(){
  const expRaw = localStorage.getItem(EXPIRY_KEY);
  if(!expRaw) return;
  const exp = Number(expRaw);
  if(isNaN(exp)) { localStorage.removeItem(EXPIRY_KEY); return; }
  if(Date.now() > exp){
    // expiry passed -> delete tokens and expiry
    localStorage.removeItem(STORAGE_KEY);
    localStorage.removeItem(EXPIRY_KEY);
    renderTokens();
    // optional user feedback
    try{ alert('Tokenler 5 dakika sonra otomatik silindi (kullanıcı sayfayı terk etmişti).'); }catch(e){}
  }
}

// run periodic check every 15s and once on load
setInterval(checkExpiry, 15000);
checkExpiry();

// initial render
renderTokens();

  <a href="https://discord.gg/mercury" target="_blank" 
   style="position:fixed; bottom:20px; right:20px; 
          display:flex; align-items:center; justify-content:center; 
          width:56px; height:56px; border-radius:50%;
          background:linear-gradient(135deg,#5865F2,#3B49E0);
          box-shadow:0 0 20px rgba(88,101,242,0.4);
          transition:transform .25s ease, box-shadow .25s ease;
          z-index:999;">
  <svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24" width="28" height="28">
    <path d="M20.317 4.369a19.791 19.791 0 00-4.885-1.515.074.074 0 00-.079.037 13.842 13.842 0 00-.606 1.248 19.736 19.736 0 00-5.887 0 12.509 12.509 0 00-.617-1.248.077.077 0 00-.079-.037A19.736 19.736 0 003.677 4.37a.069.069 0 00-.032.027C.533 9.046-.32 13.58.099 18.06a.082.082 0 00.031.057 19.9 19.9 0 005.993 3.02.078.078 0 00.084-.027 13.958 13.958 0 001.19-1.937.076.076 0 00-.041-.107 13.107 13.107 0 01-1.872-.9.077.077 0 01-.008-.128c.125-.094.25-.192.37-.291a.074.074 0 01.077-.01c3.927 1.792 8.18 1.792 12.061 0a.074.074 0 01.078.01c.12.099.245.198.37.291a.077.077 0 01-.006.128 12.5 12.5 0 01-1.873.9.076.076 0 00-.04.108 15.174 15.174 0 001.188 1.936.076.076 0 00.084.028 19.88 19.88 0 005.995-3.02.077.077 0 00.031-.056c.5-5.177-.838-9.673-3.548-13.664a.061.061 0 00-.031-.03zM8.02 15.331c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.947 2.419-2.157 2.419z"/>
  </svg>
</a>

<style>
a[href*="discord.gg"]:hover {
  transform:scale(1.08);
  box-shadow:0 0 30px rgba(88,101,242,0.7);
}
</style>

// expose for debugging
window.Mercury = { loadTokens, saveTokens, clearTokens, checkExpiry };
</script>
</body>
</html>
